# Warranty Parser

Этот проект предназначен для автоматизированного преобразования и фильтрации данных о гарантиях из Excel-файлов.



## Структура проекта

```
project_root/
├── src/
│   ├── input/         # Входные Excel-файлы (сюда кладите любые исходные файлы)
│   │   └── README.md  # Инструкция по формату входных файлов
│   ├── output/        # Результаты работы скрипта (target.xlsx)
│   └── main.py        # Основной скрипт
├── requirements.txt   # Зависимости Python
└── README.md          # Эта инструкция
```

## Быстрый старт

### Запуск через Docker

#### Для Linux/macOS (рекомендуется):

1. **Соберите Docker-образ:**
   ```bash
   docker build -t warranty-parser .
   ```

2. **Запустите контейнер:**
   ```bash
   docker run --rm \
     -u $(id -u):$(id -g) \
     -v $(pwd)/src/input:/app/input \
     -v $(pwd)/src/output:/app/output \
     warranty-parser
   ```
   - Ключ `-u $(id -u):$(id -g)` гарантирует, что все созданные файлы будут принадлежать вашему пользователю, а не root.
   - Папки `src/input` и `src/output` будут использоваться как volume: вы просто кладёте файлы в `src/input`, а результат появляется в `src/output`.
   - Ключ `--rm` гарантирует, что контейнер будет автоматически удалён после завершения работы (не будет скапливаться лишних контейнеров).

#### Для Windows:

1. **Соберите Docker-образ:**
   ```powershell
   docker build -t warranty-parser .
   ```

2. **Запустите контейнер:**
   ```powershell
   docker run --rm -v %cd%\src\input:/app/input -v %cd%\src\output:/app/output warranty-parser
   ```
   - На Windows проблема с правами на файлы обычно не возникает, но если возникнет — запустите PowerShell/командную строку от имени администратора.

3. **Результат:**
   - После завершения работы контейнера результат будет лежать в `src/output/target.xlsx`.

--- 

### Запуск без Docker

1. **Создайте и активируйте виртуальное окружение (рекомендуется):**
   ```bash
   python -m venv venv
   source venv/bin/activate  # для Linux/Mac
   venv\Scripts\activate    # для Windows
   ```

2. **Установите зависимости:**
   ```bash
   pip install -r requirements.txt
   ```

3. **Подготовьте входные данные:**
   - Поместите один или несколько Excel-файлов с листом `Гарантия` в папку `src/input/`.
   - Подробная инструкция по формату входных файлов находится в `src/input/README.md`.
   - Файлы могут называться как угодно, главное — формат и наличие нужного листа.

4. **Запустите скрипт:**
   ```bash
   cd src
   python main.py
   ```
   или
   ```bash
   python -m main
   ```

5. **Результат:**
   - Готовый файл появится в папке `src/output/` с именем `target.xlsx`.
   - Данные из всех файлов будут объединены, отформатированы, дубликаты удалены, столбцы и цвета приведены к нужному виду.

## Описание работы
- Скрипт читает данные с листа `Гарантия` из всех Excel-файлов в папке `src/input/`.
- Формирует итоговую таблицу с нужными столбцами и форматированием.
- Проверяет и удаляет дубликаты по серийному номеру.
- Сохраняет результат в `src/output/target.xlsx`.
- Автоматически раскрашивает столбцы "Уровень поддержки" и "Срок" для удобства визуального анализа.

## Требования
- Python 3.8+
- pandas
- openpyxl
- pyarrow

## Примечания
- Если структура входных файлов отличается, отредактируйте имя листа или шаблон в `main.py`.